<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="stylesheet" href="custom.page.css" />

    <title>Timer Settings!</title>
  </head>
  <body>
    <div class="mnt">
      <h1>Custom Preset</h1>
      <p>
        On this page you can customize your time according to your preference.
      </p>
    </div>
    <div class="container">
      <p><label for="name">Name:</label></p>
      <input type="text" name="name" id="name" value="" />
      <p><label for="focus">Focus:</label></p>
      <input type="text" name="focus" id="focus" value="" />

      <p><label for="break">Break:</label></p>
      <input type="text" name="break" id="break" value="" />

      <p><label for="cycle">Cycles:</label></p>
      <input type="text" name="cycles" id="cycles" value="" />

      <div class="categ">
        <p><label for="category">Category:</label></p>
        <select id="category" name="category">
          <option value="gaming">Gaming</option>
          <option value="exercise">Exercise</option>
          <option value="study">Study</option>
          <option value="cooking">Cooking</option>
          <option value="cleaning">House cleaning</option>
        </select>
      </div>

      <div class="save-message"></div>

      <div id="savedInputs"></div>
      <p>
        <a href="#" id="saveButton" class="pill-button">Save</a>
      </p>
    </div>

    <script>
      const SAVING_MESSAGE = "Saving.....";
      const SAVED_MESSAGE = "all changes are saved";
      const SAVE_BUTTON_TEXT = "Save";
      const SAVE_FAILED_MESSAGE = "Failed to save changes";

      document.addEventListener("DOMContentLoaded", () => {
        const saveButton = document.getElementById("saveButton");
        const saveMessage = document.querySelector(".save-message");
        const savedInputsDiv = document.getElementById("savedInputs");

        saveButton.addEventListener("click", (event) => {
          event.preventDefault();
          saveButton.textcontent = SAVING_MESSAGE;

          const name = document.getElementById("name").value;
          const focus = document.getElementById("focus").value;
          const breakTime = document.getElementById("break").value;
          const cycles = document.getElementById("cycles").value;
          const category = document.getElementById("category").value;

          const formData = {
            name: name,
            focus: focus,
            break: breakTime,
            cycles: cycles,
            category: category,
          };

          //Saved data
          localStorage.setItem(category, JSON.stringify(formData));
          try {
            console.log({ [category]: formData });

            saveButton.textContent = SAVE_BUTTON_TEXT;
            saveMessage.textContent = SAVED_MESSAGE;
            displaySavedInputs(formData);
          } catch (error) {
            console.error(
              "There has been a problem with your operation:",
              error
            );
            saveButton.textContent = SAVE_BUTTON_TEXT;
            saveMessage.textContent = SAVE_FAILED_MESSAGE;
          }
        });

        function displaySavedInputs(formData) {
          const { name, focus, break: breakTime, cycles, category } = formData;
          const savedInputsText = `Name: ${name}, Focus: ${focus}, Break: ${breakTime}, Cycles: ${cycles}, Category: ${category}`;
          savedInputsDiv.innerHTML += `<p>${savedInputsText}</p>`;
        }
      });
    </script>
  </body>
</html>
