<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="stylesheet" href="customisepage.css" />
    <script src="customise.js" defer></script>
    <title>Timeout!</title>
  </head>
  <body>
    <div class="category">
      <button class="pill" id="studyButton" type="button">Study</button>
      <button class="pill" id="exerciseButton" type="button">Exercise</button>
      <button class="pill" id="gamingButton" type="button">Gaming</button>
      <button class="pill" id="doschoolworkButton" type="button">
        Do school work
      </button>
    </div>
    <div class="categ-container">
      <select id="timeselect" class="dropdown">
        <option value="5">5 min</option>
        <option value="10">10 min</option>
        <option value="20">20 min</option>
        <option value="30">30 min</option>
        <option value="3break">3 min break</option>
        <option value="5break">5 min break</option>
      </select>
    </div>
    <div class="container">
      <p class="draggable" draggable="true">5 min</p>
      <p class="draggable" draggable="true">20 min</p>
    </div>

    <script type="text/javascript">
      document.addEventListener("DOMContentLoaded", function () {
        const timeselect = document.getElementById("timeselect");

        function toggleDropdown() {
          if (timeselect.classList.contains("show")) {
            timeselect.classList.remove("show");
          } else {
            timeselect.classList.add("show");
          }
        }

        function showDropdown(buttonId) {
          timeselect.setAttribute("data-category", buttonId);
          toggleDropdown();
        }

        function saveTime(category, time) {
          let timeArray = JSON.parse(localStorage.getItem(category)) || [];
          timeArray.push(time);

          localStorage.setItem(category, JSON.stringify(timeArray));
          console.log(`${category} time saved:`, time);
        }

        document
          .getElementById("studyButton")
          .addEventListener("click", function () {
            showDropdown("studyTime");
          });

        document
          .getElementById("exerciseButton")
          .addEventListener("click", function () {
            showDropdown("exerciseTime");
          });

        document
          .getElementById("gamingButton")
          .addEventListener("click", function () {
            showDropdown("gamingTime");
          });

        document
          .getElementById("doschoolworkButton")
          .addEventListener("click", function () {
            showDropdown("doSchoolWorkTime");
          });

        timeselect.addEventListener("change", function () {
          const selectedTime = this.value;
          const category = this.getAttribute("data-category");
          if (selectedTime.includes("break")) {
            saveTime(category, selectedTime.split("break")[0]); //savetimebreak
          } else {
            saveTime(category, selectedTime);
          }
          toggleDropdown();
        });
      });
    </script>
  </body>
</html>
